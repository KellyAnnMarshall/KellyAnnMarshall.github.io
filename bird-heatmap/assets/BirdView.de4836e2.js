import{i as v,b,c as C}from"./gmaps.b195cf8c.js";import{_ as g,o as n,c as d,r as L,a as s,w as y,v as h,F as m,b as p,t as u,n as T,d as B,e as M,f as w,g as Y,p as x,h as D}from"./index.cac6bd65.js";const k={name:"bird-map",props:["name","selectedBird","birdData","countyData","selectedYear"],watch:{selectedBird(){this.setMapStyles()},selectedYear(){this.setMapStyles()}},data(){return{vueGMap:null,mapName:this.name+"-map",API_KEY:"AIzaSyDfg24RRLOVbQFWVCN0Mx4bMGQqmpKqPfs",minZoomLevel:5,maxZoomLevel:10,UKBounds:{north:61.434329,south:49.758414,east:3.229716,west:-11.55975}}},methods:{googleMapsFailedToLoad(){this.vueGMap="Error occurred"},setMapStyles(){this.vueGMap.data.setStyle(e=>{var t=e.getProperty("name"),r="#000";return this.birdData.map(o=>{o.species===this.selectedBird&&o.county===t&&(e.setProperty("bird",o),r=this.setColor(o[this.selectedYear]))}),{fillColor:r,fillOpacity:.8,strokeColor:"#000",strokeOpacity:.2,strokeWeight:1}}),this.vueGMap.data.addListener("mouseover",e=>{var t=e.feature.getProperty("name");this.vueGMap.data.revertStyle(),this.vueGMap.data.overrideStyle(e.feature,{fillOpacity:1}),this.requestHighlight(t)}),this.vueGMap.data.addListener("mouseout",()=>{this.vueGMap.data.revertStyle(),this.requestReset()})},requestHighlight(e){this.$emit("highlight",e)},requestReset(){this.$emit("reset")},setColor(e){return e>95?"#990100":e>90?"#cc0001":e>85?"#fe0000":e>80?"#ff3300":e>75?"#ff6600":e>70?"#fe9900":e>65?"#ffcc00":e>60?"#fffc00":e>55?"#cbfe33":e>50?"#98ff66":e>45?"#67ff9a":e>40?"#33ffcc":e>35?"#00ffff":e>30?"#00ccff":e>25?"#0099ff":e>20?"#0166ff":e>15?"#0000fe":e>10?"#0033ff":e>5?"#0000cc":"#000098"},requestLoaded(){this.mapLoaded=!0,this.$emit("mapLoaded")},requestLoading(){this.$emit("mapLoading")}},async mounted(){try{const e=await v();this.requestLoading();const t=this.$el,r={zoom:6,center:{lat:56.0053834,lng:-2.5742888},restriction:{latLngBounds:this.UKBounds,strictBounds:!1},disableDefaultUI:!0,zoomControl:!0,minZoom:this.minZoomLevel,maxZoom:this.maxZoomLevel,scaleControl:!0,styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]}]};this.vueGMap=new e.maps.Map(t,r),this.vueGMap.data.addGeoJson(this.countyData),window.innerWidth<500&&this.vueGMap.fitBounds(this.UKBounds),this.setMapStyles(),this.requestLoaded()}catch{this.googleMapsFailedToLoad}}},S=["id"];function G(e,t,r,o,i,l){return n(),d("div",{class:"google-map",id:i.mapName},null,8,S)}const q=g(k,[["render",G]]);const I={name:"BirdView",components:{BirdMap:q},data(){return{loaded:!1,selectedCounty:null,selectedYear:this.getCurrentYear(),birdData:b,countyData:C,birdOptions:[],selectedBird:"Robin",yearLookup:this.getYearLookup()}},computed:{imageFilePath(){return`./assets/images/${this.selectedBird.replace(/\s+/g,"-").toLowerCase()}.png`},highlightedCounty(){var e=this.birdData.find(t=>t.county.match(this.selectedCounty)&&t.species.match(this.selectedBird));return e.activeColor=this.setColor(e[this.selectedYearColumn]),e},yearOptions(){return this.yearLookup.map(e=>e.year)},selectedYearColumn(){return"percent_gardens_"+this.selectedYear}},methods:{getYearLookup(){let e=[],t=this.getCurrentYear();console.log(t);let r=2018;for(;r<=t;){let o={year:r,column:`percent_gardens_${r}`};e.push(o),r+=1}return e},getCurrentYear(){return new Date().getFullYear()},highlightCounty(e){this.selectedCounty=e},resetCounty(){this.selectedCounty=null},mapIsLoaded(){this.loaded=!0},mapIsLoading(){this.loaded=!1},setColor(e){return e>95?"#990100":e>90?"#cc0001":e>85?"#fe0000":e>80?"#ff3300":e>75?"#ff6600":e>70?"#fe9900":e>65?"#ffcc00":e>60?"#fffc00":e>55?"#cbfe33":e>50?"#98ff66":e>45?"#67ff9a":e>40?"#33ffcc":e>35?"#00ffff":e>30?"#00ccff":e>25?"#0099ff":e>20?"#0166ff":e>15?"#0000fe":e>10?"#0033ff":e>5?"#0000cc":"#000098"}},created(){var e=[];this.birdData.filter(t=>{if(e.indexOf(t.species)===-1)return e.push(t.species)}),this.birdOptions=e.sort()}},c=e=>(x("data-v-39c2d368"),e=e(),D(),e),O={class:"container mt-3 mt-lg-5 position-relative"},V=["src","alt"],F={class:"d-flex justify-content-lg-end"},N={class:"d-flex"},P=c(()=>s("label",{for:"bird",class:"visually-hidden"},"Bird:",-1)),R=["value"],U=c(()=>s("label",{for:"year",class:"visually-hidden"},"Year:",-1)),Z=["value"],z={class:"d-flex justify-content-lg-end mt-3"},K={class:"legend m-0"},H={key:0},j={class:"visually-hidden"},E={class:"figcaption_percent"},W={class:"figcaption_data"},A=c(()=>s("div",{class:"lds-ripple"},[s("div"),s("div")],-1)),Q=[A];function J(e,t,r,o,i,l){const _=L("bird-map");return n(),d("div",null,[s("div",O,[s("img",{class:"bird",src:l.imageFilePath,alt:i.selectedBird},null,8,V),s("div",F,[s("div",N,[P,y(s("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.selectedBird=a),class:"dropdown-list mb-1"},[(n(!0),d(m,null,p(i.birdOptions,(a,f)=>(n(),d("option",{key:f,value:a},u(a),9,R))),128))],512),[[h,i.selectedBird]]),U,y(s("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>i.selectedYear=a),class:"dropdown-list mb-1 ms-3"},[(n(!0),d(m,null,p(l.yearOptions,(a,f)=>(n(),d("option",{key:f,value:a},u(a),9,Z))),128))],512),[[h,i.selectedYear]])])]),s("div",z,[s("figure",K,[i.selectedCounty?(n(),d("figcaption",H,[s("p",j,u(i.selectedBird),1),s("span",{class:"figcaption_county",style:T({borderLeftColor:l.highlightedCounty.activeColor})},u(l.highlightedCounty.county),5),s("span",E,[s("span",W,u(l.highlightedCounty[this.selectedYearColumn])+"% ",1),B(" of gardens ")])])):M("",!0)])])]),s("div",{class:w(["loader",{"is-paused fade":!this.loaded}])},Q,2),Y(_,{name:"bird-map",countyData:i.countyData,birdData:i.birdData,selectedBird:i.selectedBird,selectedYear:l.selectedYearColumn,onHighlight:l.highlightCounty,onReset:l.resetCounty,onMapLoaded:l.mapIsLoaded,onMapLoading:l.mapIsLoading},null,8,["countyData","birdData","selectedBird","selectedYear","onHighlight","onReset","onMapLoaded","onMapLoading"])])}const ee=g(I,[["render",J],["__scopeId","data-v-39c2d368"]]);export{ee as default};
