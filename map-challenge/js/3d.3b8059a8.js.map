{"version":3,"sources":["webpack:///./src/views/11-3D.vue?1c44","webpack:///./src/views/11-3D.vue","webpack:///./src/views/11-3D.vue?dc4f"],"names":["class","ref","data","accessToken","map","methods","updateCameraPosition","position","altitude","target","camera","this","getFreeCameraOptions","MercatorCoordinate","fromLngLat","lookAtPoint","setFreeCameraOptions","initMap","Map","container","$refs","zoom","center","pitch","bearing","style","interactive","on","addSource","type","url","tileSize","maxzoom","setTerrain","source","exaggeration","addLayer","id","paint","animationIndex","animationTime","once","lerp","a","b","t","Array","isArray","result","i","Math","min","length","animations","duration","animate","phase","start","end","alt","target1","target2","easeInOutQuad","lastTime","frame","time","current","elapsed","window","requestAnimationFrame","mounted","__exports__","render"],"mappings":"6HAAA,W,6ICCOA,MAAM,iC,uBACT,eAEM,OAFDA,MAAM,2CAAyC,CAClD,eAAgD,MAA5CA,MAAM,UAAQ,CAAC,eAAsB,YAAhB,a,eAAgB,U,SAEtCC,IAAI,WAAWD,MAAM,W,gDAJ5B,eAKM,MALN,EAKM,CAJJ,EAGA,eAA0C,MAA1C,EAA0C,Y,mCAQ/B,G,UAAA,CACbE,KADa,WAEX,MAAO,CACLC,YACE,+FACFC,IAAK,OAGTC,QAAS,CACPC,qBADO,SACcC,EAAUC,EAAUC,GACvC,IAAMC,EAASC,KAAKP,IAAIQ,uBAExBF,EAAOH,SAAW,IAASM,mBAAmBC,WAC5CP,EACAC,GAEFE,EAAOK,YAAYN,GAEnBE,KAAKP,IAAIY,qBAAqBN,IAEhCO,QAZO,WAYG,WACR,IAASd,YAAcQ,KAAKR,YAE5BQ,KAAKP,IAAM,IAAI,IAASc,IAAI,CAC1BC,UAAWR,KAAKS,MAAM,YACtBC,KAAM,MACNC,OAAQ,EAAE,mBAAoB,mBAC9BC,MAAO,GACPC,QAAS,EACTC,MAAO,sCACPC,aAAa,IAIff,KAAKP,IAAIuB,GAAG,QAAQ,WAClB,EAAKvB,IAAIwB,UAAU,aAAc,CAC/BC,KAAM,aACNC,IAAK,wCACLC,SAAU,IACVC,QAAS,KAEX,EAAK5B,IAAI6B,WAAW,CAAEC,OAAQ,aAAcC,aAAc,MAE1D,EAAK/B,IAAIgC,SAAS,CAChBC,GAAI,MACJR,KAAM,MACNS,MAAO,CACL,WAAY,aACZ,qBAAsB,CAAC,EAAK,IAC5B,+BAAgC,SAKtC,IAAIC,EAAiB,EACjBC,EAAgB,EAGpB7B,KAAKP,IAAIqC,KAAK,QAAQ,WAEpB,IAAMC,EAAO,SAACC,EAAGC,EAAGC,GAClB,GAAIC,MAAMC,QAAQJ,IAAMG,MAAMC,QAAQH,GAAI,CAExC,IADA,IAAMI,EAAS,GACNC,EAAI,EAAGA,EAAIC,KAAKC,IAAIR,EAAES,OAAQR,EAAEQ,QAASH,IAChDD,EAAOC,GAAKN,EAAEM,IAAM,EAAMJ,GAAKD,EAAEK,GAAKJ,EACxC,OAAOG,EAEP,OAAOL,GAAK,EAAME,GAAKD,EAAIC,GAIzBQ,EAAa,CACjB,CACEC,SAAU,IACVC,QAAS,SAACC,GACR,IAAMC,EAAQ,EAAE,mBAAoB,oBAC9BC,EAAM,EAAE,mBAAoB,mBAC5BC,EAAM,CAAC,IAAQ,KAGfpD,EAAWmC,EAAKe,EAAOC,EAAKF,GAC5BhD,EAAWkC,EAAKiB,EAAI,GAAIA,EAAI,GAAIH,GAChC/C,EAAS,EAAE,kBAAmB,oBAEpC,EAAKH,qBAAqBC,EAAUC,EAAUC,KAGlD,CACE6C,SAAU,KACVC,QAAS,SAACC,GACR,IAAMC,EAAQ,EAAE,mBAAoB,mBAC9BC,EAAM,EAAE,mBAAoB,mBAC5BC,EAAM,CAAC,IAAQ,KACfC,EAAU,EAAE,kBAAmB,oBAC/BC,EAAU,EAAE,mBAAoB,mBAGhCtD,EAAWmC,EAAKe,EAAOC,EAAKF,GAC5BhD,EAAWkC,EAAKiB,EAAI,GAAIA,EAAI,GAAIH,GAChC/C,EAASiC,EAAKkB,EAASC,EAASL,GAEtC,EAAKlD,qBAAqBC,EAAUC,EAAUC,KAGlD,CACE6C,SAAU,KACVC,QAAS,SAACC,GAER,IAAMM,EAAgB,SAACjB,GACrB,OAAOA,EAAI,GAAM,EAAMA,EAAIA,GAAK,EAAM,EAAMA,GAAKA,EAAI,GAEjDY,EAAQ,EAAE,mBAAoB,mBAC9BC,EAAM,EAAE,mBAAoB,oBAC5BC,EAAM,CAAC,IAAQ,KACfC,EAAU,EAAE,mBAAoB,mBAChCC,EAAU,EAAE,kBAAmB,oBAG/BtD,EAAWmC,EAAKe,EAAOC,EAAKI,EAAcN,IAC1ChD,EAAWkC,EAAKiB,EAAI,GAAIA,EAAI,GAAIH,GAChC/C,EAASiC,EAAKkB,EAASC,EAASL,GAEtC,EAAKlD,qBAAqBC,EAAUC,EAAUC,MAKhDsD,EAAW,EACf,SAASC,EAAMC,GACb1B,GAAkBc,EAAWD,OAC7B,IAAMc,EAAUb,EAAWd,GAE3B,GAAIC,EAAgB0B,EAAQZ,SAAU,CAEpC,IAAME,EAAQhB,EAAgB0B,EAAQZ,SACtCY,EAAQX,QAAQC,GAIlB,IAAMW,EAAUF,EAAOF,EACvBvB,GAAiB2B,EACjBJ,EAAWE,EAEPzB,EAAgB0B,EAAQZ,WAC1Bf,IACAC,EAAgB,GAGlB4B,OAAOC,sBAAsBL,GAG/BI,OAAOC,sBAAsBL,QAInCM,QA3Ja,WA4JX3D,KAAKM,a,iCClKT,MAAMsD,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E","file":"js/3d.3b8059a8.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./11-3D.vue?vue&type=style&index=0&id=5e61b000&lang=scss&scoped=true\"","<template>\n  <div class=\"position-relative h-100 w-100\">\n    <div class=\"map-header position-absolute text-light\">\n      <h2 class=\"h3 m-0\"><span>Day 11 - </span>3D</h2>\n    </div>\n    <div ref=\"map-root\" class=\"basemap\"></div>\n  </div>\n</template>\n\n<script>\nimport mapboxgl from \"mapbox-gl\";\nimport \"mapbox-gl/src/css/mapbox-gl.css\";\n\nexport default {\n  data() {\n    return {\n      accessToken:\n        \"pk.eyJ1Ijoia21hcnNoYWxsIiwiYSI6ImNrdXdudGlpODI2ejkydXF2bXcyM3poaWQifQ.hyBCr6uwWlDGMGyVmuKCIw\",\n      map: null,\n    };\n  },\n  methods: {\n    updateCameraPosition(position, altitude, target) {\n      const camera = this.map.getFreeCameraOptions();\n\n      camera.position = mapboxgl.MercatorCoordinate.fromLngLat(\n        position,\n        altitude\n      );\n      camera.lookAtPoint(target);\n\n      this.map.setFreeCameraOptions(camera);\n    },\n    initMap() {\n      mapboxgl.accessToken = this.accessToken;\n\n      this.map = new mapboxgl.Map({\n        container: this.$refs[\"map-root\"],\n        zoom: 11.53,\n        center: [-3.2258605957031246, 55.95342878289969],\n        pitch: 96,\n        bearing: 0,\n        style: \"mapbox://styles/mapbox/satellite-v9\",\n        interactive: false,\n      });\n\n      // add terrain and sky layers once the style has loaded\n      this.map.on(\"load\", () => {\n        this.map.addSource(\"mapbox-dem\", {\n          type: \"raster-dem\",\n          url: \"mapbox://mapbox.mapbox-terrain-dem-v1\",\n          tileSize: 512,\n          maxzoom: 14,\n        });\n        this.map.setTerrain({ source: \"mapbox-dem\", exaggeration: 1.5 });\n\n        this.map.addLayer({\n          id: \"sky\",\n          type: \"sky\",\n          paint: {\n            \"sky-type\": \"atmosphere\",\n            \"sky-atmosphere-sun\": [0.0, 90.0],\n            \"sky-atmosphere-sun-intensity\": 15,\n          },\n        });\n      });\n\n      let animationIndex = 0;\n      let animationTime = 0.0;\n\n      // wait for the terrain and sky to load before starting animations\n      this.map.once(\"idle\", () => {\n        // linearly interpolate between two altitudes/positions based on time\n        const lerp = (a, b, t) => {\n          if (Array.isArray(a) && Array.isArray(b)) {\n            const result = [];\n            for (let i = 0; i < Math.min(a.length, b.length); i++)\n              result[i] = a[i] * (1.0 - t) + b[i] * t;\n            return result;\n          } else {\n            return a * (1.0 - t) + b * t;\n          }\n        };\n\n        const animations = [\n          {\n            duration: 20000.0,\n            animate: (phase) => {\n              const start = [-3.1354808807373047, 55.940307890739426];\n              const end = [-3.2067203521728516, 55.94871923055638];\n              const alt = [1000.0, 1000.0];\n\n              // interpolate camera position while keeping focus on a target lat/lng\n              const position = lerp(start, end, phase);\n              const altitude = lerp(alt[0], alt[1], phase);\n              const target = [-3.161916732788086, 55.944153301340144];\n\n              this.updateCameraPosition(position, altitude, target);\n            },\n          },\n          {\n            duration: 15000.0,\n            animate: (phase) => {\n              const start = [-3.2100677490234375, 55.95073768027848];\n              const end = [-3.2171058654785156, 55.95049739416244];\n              const alt = [1000.0, 1000.0];\n              const target1 = [-3.161916732788086, 55.944153301340144];\n              const target2 = [-3.1850051879882812, 55.95270797018195];\n\n              // interpolate both the camera position and target\n              const position = lerp(start, end, phase);\n              const altitude = lerp(alt[0], alt[1], phase);\n              const target = lerp(target1, target2, phase);\n\n              this.updateCameraPosition(position, altitude, target);\n            },\n          },\n          {\n            duration: 15000.0,\n            animate: (phase) => {\n              // create easing function for the animation\n              const easeInOutQuad = (t) => {\n                return t < 0.5 ? 2.0 * t * t : (4.0 - 2.0 * t) * t - 1.0;\n              };\n              const start = [-3.2171058654785156, 55.95049739416244];\n              const end = [-3.1354808807373047, 55.940307890739426];\n              const alt = [1000.0, 1000.0];\n              const target1 = [-3.1850051879882812, 55.95270797018195];\n              const target2 = [-3.161916732788086, 55.944153301340144];\n\n              // interpolate both the camera position and target\n              const position = lerp(start, end, easeInOutQuad(phase));\n              const altitude = lerp(alt[0], alt[1], phase);\n              const target = lerp(target1, target2, phase);\n\n              this.updateCameraPosition(position, altitude, target);\n            },\n          },\n        ];\n\n        let lastTime = 0.0;\n        function frame(time) {\n          animationIndex %= animations.length;\n          const current = animations[animationIndex];\n\n          if (animationTime < current.duration) {\n            // Normalize the duration between 0 and 1 to interpolate the animation\n            const phase = animationTime / current.duration;\n            current.animate(phase);\n          }\n\n          // Elasped time since last frame, in milliseconds\n          const elapsed = time - lastTime;\n          animationTime += elapsed;\n          lastTime = time;\n\n          if (animationTime > current.duration) {\n            animationIndex++;\n            animationTime = 0.0;\n          }\n\n          window.requestAnimationFrame(frame);\n        }\n\n        window.requestAnimationFrame(frame);\n      });\n    },\n  },\n  mounted() {\n    this.initMap();\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../assets/scss/map-shared.scss\";\n</style>\n","import { render } from \"./11-3D.vue?vue&type=template&id=5e61b000&scoped=true\"\nimport script from \"./11-3D.vue?vue&type=script&lang=js\"\nexport * from \"./11-3D.vue?vue&type=script&lang=js\"\n\nimport \"./11-3D.vue?vue&type=style&index=0&id=5e61b000&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/kellymarshall/Sites/30-day-map-challenge/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5e61b000\"]])\n\nexport default __exports__"],"sourceRoot":""}